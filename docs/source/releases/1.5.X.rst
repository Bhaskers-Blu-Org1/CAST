.. _CAST1.5.X:

Release 1.5.0
=============

:GitHub Tag:

This release primarily targets Jitter Mitigation in the Allocation Create mechanism. Additional
QOL fixes are included for BDS, Database, Infrastructure and other CSM systems.

CSM APIs
########

* ``csmi_allocation_t`` : new field ``smt_mode``
    * Set in ``csm_allocation_create``, determines the SMT mode of the job for the allocation.
    * `0` sets the allocation to use the maximum SMT mode for the node.
    * SMT mode values exceeding the node maximum are clamped on the compute node.
* ``csm_allocation_create`` and ``csm_allocation_update_state`` now only create one 
    ``csm_allocation_node_history`` entry per allocation.
* ``csm_allocation_query_details`` now prints all metrics fields, regardless of population.
* Added a sample showing interface between CSM and xCAT. 



CSM BDS
#######

* New :ref:`metric-transaction` script in git repo for fixing historic transaction logs.
* ``source`` field moved to ``data`` for ``metric-transaction`` logs.
* ``@timestamp`` fields generated by CSM transitioned to ``timestamp``.
* Added RAS event triggering for UFM in default event correlation configuration.
* ``csm_transaction.log`` 
    * Now rolls over into multiple files with an auto incrementing number.
    * Fixed CSM failure to report all allocated nodes.
    * General fix for bad JSON.
* ``dynamic_date_formats`` bug now fixed, should repair some issues with timestamps.
* ``filebeat.prospectors`` in  sample config renamed to ``filebeat.inputs``.



CSM Daemon
##########

* Added :ref:`jitter mitigation block <CSMD_jittermitigation_Block>` to csm compute configuration.
    * For details on this mechanism see linked documentation.
* ``libcsmpam.so`` 
    * No longer prints during `session` module usage.  
    * ``Activelist`` now created if not found.
* Fix for client race condition: socket tear-down and pending send/recv.
* DB version mismatch exits more gracefully.


CSM Database
############

* Added new Migration script for 16.2 to 17.0.
* ``smt_mode`` added to ``csm_allocation`` and ``csm_allocation_history``.
* ``num_reads`` and ``num_writes`` added to ``csm_lv_history``.


RPMS
####

* Added |csm-tools| RPM.
    * Collects noarch tools for CSM utilities.
    * ``numpy`` dependency.
* Added minimum version (2.5.1) to ``python-psycopg2`` for |csm-db|.
* Added ``python-psycopg2`` and ``python-elasticsearch`` dependecies to |csm-bds|.
* Fixed |csm-logstash| and |csm-kibana| rpm scriptlets.



